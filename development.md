# Comet å¼•æ“å¼€å‘è·¯çº¿å›¾

## ğŸ“‹ å½“å‰çŠ¶æ€

### âœ… å·²å®Œæˆ
- âœ… Vulkan åŸºç¡€å°è£…ï¼ˆDevice, Buffer, Pipeline, RenderPass ç­‰ï¼‰
- âœ… åŸºç¡€æ¸²æŸ“ç³»ç»Ÿï¼ˆSceneRenderer, Rendererï¼‰
- âœ… èµ„æºç®¡ç†ï¼ˆResourceManager, Mesh, Textureï¼‰
- âœ… Frame ç®¡ç†ï¼ˆFrameManagerï¼‰
- âœ… é…ç½®ç³»ç»Ÿï¼ˆConfigï¼‰
- âœ… æ—¥å¿—ç³»ç»Ÿï¼ˆLoggerï¼‰
- âœ… æ€§èƒ½åˆ†æï¼ˆProfilerï¼‰

### âŒ å¾…å®Œæˆ
- âŒ ImGui é›†æˆ
- âŒ ECS ç³»ç»Ÿ
- âŒ æ¸²æŸ“ç³»ç»Ÿä¼˜åŒ–ï¼ˆæ‰¹é‡æ¸²æŸ“ã€æ’åºã€å¤š Passï¼‰
- âŒ ç›¸æœºç³»ç»Ÿ
- âŒ æè´¨ç³»ç»Ÿ
- âŒ å…‰ç…§ç³»ç»Ÿ
- âŒ é˜´å½±ç³»ç»Ÿ

---

## ğŸ¯ å¼€å‘ä¼˜å…ˆçº§

### Phase 1: ImGui åŸºç¡€éƒ¨ç½²ï¼ˆ1-2 å‘¨ï¼‰â­â­â­â­â­

**ç›®æ ‡**ï¼šé›†æˆ ImGuiï¼Œæä¾›è°ƒè¯•å’Œå¼€å‘å·¥å…·åŸºç¡€

#### 1.1 ImGui é›†æˆ
- [ ] æ·»åŠ  ImGui åˆ° 3rdparty
- [ ] åˆ›å»º `ImGuiContext` ç±»
- [ ] Vulkan åç«¯é›†æˆ
- [ ] åŸºç¡€çª—å£å’Œæ§ä»¶æ˜¾ç¤º

#### 1.2 è°ƒè¯•å·¥å…·
- [ ] æ€§èƒ½ç›‘æ§é¢æ¿ï¼ˆFPS, Draw Call, Frame Timeï¼‰
- [ ] èµ„æºæŸ¥çœ‹å™¨ï¼ˆçº¹ç†ã€Mesh ä¿¡æ¯ï¼‰
- [ ] é…ç½®ç¼–è¾‘å™¨ï¼ˆè¿è¡Œæ—¶ä¿®æ”¹é…ç½®ï¼‰
- [ ] æ—¥å¿—æŸ¥çœ‹å™¨

#### 1.3 å¼€å‘å·¥å…·
- [ ] åœºæ™¯æµè§ˆå™¨ï¼ˆæŸ¥çœ‹å®ä½“ã€ç»„ä»¶ï¼‰
- [ ] å±æ€§ç¼–è¾‘å™¨ï¼ˆä¿®æ”¹ç»„ä»¶å±æ€§ï¼‰
- [ ] æ¸²æŸ“è°ƒè¯•ï¼ˆæ˜¾ç¤ºæ¸²æŸ“çŠ¶æ€ï¼‰

**äº¤ä»˜ç‰©**ï¼š
- ImGui æ­£å¸¸å·¥ä½œ
- åŸºç¡€è°ƒè¯•é¢æ¿å¯ç”¨
- ä¸ºåç»­å¼€å‘æä¾›å·¥å…·æ”¯æŒ

---

### Phase 2: ECS åŸºæœ¬åŠŸèƒ½ï¼ˆ2-3 å‘¨ï¼‰â­â­â­â­

**ç›®æ ‡**ï¼šå®ç°æ ¸å¿ƒ ECS ç³»ç»Ÿï¼Œæ”¯æŒå®ä½“-ç»„ä»¶-ç³»ç»Ÿæ¶æ„

#### 2.1 ECS æ ¸å¿ƒç³»ç»Ÿ
- [ ] **Entity** - å®ä½“ ID ç®¡ç†
- [ ] **TypeId** - ç±»å‹ ID ç³»ç»Ÿ
- [ ] **ComponentStorage** - Sparse Set å®ç°ï¼ˆç»„ä»¶å­˜å‚¨ï¼‰
- [ ] **Registry** - ç»„ä»¶æ³¨å†Œè¡¨
- [ ] **World** - ECS å®¹å™¨

#### 2.2 ç³»ç»Ÿæ¡†æ¶
- [ ] **System** - ç³»ç»ŸåŸºç±»
- [ ] **SystemManager** - ç³»ç»Ÿç®¡ç†
- [ ] **World::update()** - ç³»ç»Ÿæ›´æ–°æµç¨‹

#### 2.3 åŸºç¡€ç»„ä»¶
- [ ] **TransformComponent** - å˜æ¢ç»„ä»¶ï¼ˆä½ç½®ã€æ—‹è½¬ã€ç¼©æ”¾ï¼‰
- [ ] **MeshComponent** - ç½‘æ ¼ç»„ä»¶
- [ ] **HierarchyComponent** - å±‚çº§å…³ç³»ç»„ä»¶ï¼ˆçˆ¶å­å…³ç³»ï¼‰

#### 2.4 åŸºç¡€ç³»ç»Ÿ
- [ ] **TransformSystem** - å˜æ¢ç³»ç»Ÿï¼ˆè®¡ç®—ä¸–ç•ŒçŸ©é˜µï¼‰
- [ ] **RenderSystem** - æ¸²æŸ“ç³»ç»Ÿï¼ˆä½¿ç”¨ SceneRendererï¼‰

**ç›®å½•ç»“æ„**ï¼š
```
engine/src/ecs/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ entity.h/cpp
â”‚   â”œâ”€â”€ type_id.h
â”‚   â”œâ”€â”€ registry.h/cpp
â”‚   â””â”€â”€ world.h/cpp
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ transform_component.h/cpp
â”‚   â”œâ”€â”€ mesh_component.h/cpp
â”‚   â””â”€â”€ hierarchy_component.h/cpp
â””â”€â”€ systems/
    â”œâ”€â”€ system.h
    â”œâ”€â”€ transform_system.h/cpp
    â””â”€â”€ render_system.h/cpp
```

**äº¤ä»˜ç‰©**ï¼š
- ECS æ ¸å¿ƒåŠŸèƒ½å®Œæ•´
- å¯ä»¥åˆ›å»ºå®ä½“ã€æ·»åŠ ç»„ä»¶ã€è¿è¡Œç³»ç»Ÿ
- åŸºç¡€æ¸²æŸ“ç³»ç»Ÿé›†æˆ ECS

---

### Phase 3: æ¸²æŸ“ç³»ç»Ÿå®Œå–„ï¼ˆ4-6 å‘¨ï¼‰â­â­â­â­â­

**ç›®æ ‡**ï¼šå®Œå–„æ¸²æŸ“ç³»ç»Ÿï¼Œæ”¯æŒç°ä»£æ¸²æŸ“ç‰¹æ€§

#### 3.1 æ¸²æŸ“é˜Ÿåˆ—ç³»ç»Ÿï¼ˆ1 å‘¨ï¼‰
- [ ] **RenderQueue** - æ¸²æŸ“é˜Ÿåˆ—
- [ ] **RenderItem** - æ¸²æŸ“é¡¹ç»“æ„
- [ ] **æ’åºç³»ç»Ÿ** - æŒ‰æ·±åº¦ã€æè´¨æ’åº
- [ ] **æ‰¹é‡æäº¤** - æ”¶é›†åç»Ÿä¸€æ¸²æŸ“

#### 3.2 ç›¸æœºç³»ç»Ÿï¼ˆ1 å‘¨ï¼‰
- [ ] **Camera** - ç›¸æœºç±»
- [ ] **CameraComponent** - ç›¸æœºç»„ä»¶
- [ ] **CameraSystem** - ç›¸æœºç³»ç»Ÿ
- [ ] **å¤šç›¸æœºæ”¯æŒ** - ä¸»ç›¸æœºã€UI ç›¸æœº

#### 3.3 æè´¨ç³»ç»Ÿï¼ˆ1 å‘¨ï¼‰
- [ ] **Material** - æè´¨ç±»
- [ ] **MaterialManager** - æè´¨ç®¡ç†
- [ ] **MaterialComponent** - æè´¨ç»„ä»¶
- [ ] **æè´¨ç¼“å­˜** - DescriptorSet ç¼“å­˜

#### 3.4 å¤š Pipeline æ”¯æŒï¼ˆ1 å‘¨ï¼‰
- [ ] **PipelineManager æ‰©å±•** - æ”¯æŒå¤šä¸ª Pipeline
- [ ] **Pipeline åˆ‡æ¢** - åŠ¨æ€åˆ‡æ¢ Pipeline
- [ ] **Shader ç®¡ç†** - å¤š Shader æ”¯æŒ

#### 3.5 æ‰¹é‡æ¸²æŸ“ä¼˜åŒ–ï¼ˆ1 å‘¨ï¼‰
- [ ] **Instancing** - GPU å®ä¾‹åŒ–æ¸²æŸ“
- [ ] **Batching** - æ‰¹é‡æ¸²æŸ“ä¼˜åŒ–
- [ ] **çŠ¶æ€ç¼“å­˜** - å‡å°‘çŠ¶æ€åˆ‡æ¢

#### 3.6 å¤š Pass æ¸²æŸ“ï¼ˆ1-2 å‘¨ï¼‰
- [ ] **RenderPipeline** - æ¸²æŸ“ç®¡çº¿ç®¡ç†
- [ ] **Pass ç³»ç»Ÿ** - å¤š Pass æ”¯æŒ
- [ ] **Shadow Pass** - é˜´å½±æ¸²æŸ“ Pass
- [ ] **Post Process Pass** - åå¤„ç† Passï¼ˆå¯é€‰ï¼‰

#### 3.7 å…‰ç…§ç³»ç»Ÿï¼ˆ1 å‘¨ï¼‰
- [ ] **Light** - å…‰æºç±»
- [ ] **LightComponent** - å…‰æºç»„ä»¶
- [ ] **LightSystem** - å…‰æºç³»ç»Ÿ
- [ ] **å¤šå…‰æºæ”¯æŒ** - æ–¹å‘å…‰ã€ç‚¹å…‰æºã€èšå…‰ç¯

#### 3.8 é˜´å½±ç³»ç»Ÿï¼ˆ1-2 å‘¨ï¼‰
- [ ] **ShadowPass** - é˜´å½±æ¸²æŸ“ Pass
- [ ] **ShadowMap** - é˜´å½±è´´å›¾ç®¡ç†
- [ ] **é˜´å½±é‡‡æ ·** - Shader ä¸­é‡‡æ ·é˜´å½±
- [ ] **CSM** - Cascaded Shadow Mapsï¼ˆå¯é€‰ï¼‰

**äº¤ä»˜ç‰©**ï¼š
- å®Œæ•´çš„æ¸²æŸ“ç³»ç»Ÿ
- æ”¯æŒæ‰¹é‡æ¸²æŸ“ã€å¤š Passã€é˜´å½±
- æ€§èƒ½ä¼˜åŒ–å®Œæˆ

---

## ğŸ“Š å…³é”®æ¶æ„è¯´æ˜

### æ¸²æŸ“ç³»ç»Ÿåˆ†å±‚
```
Renderer (åº”ç”¨æ¥å£)
  â†“
SceneRenderer (æ¸²æŸ“ç®¡çº¿ç®¡ç†)
  â†“
RenderPipeline (å¤š Pass ç®¡ç†)
  â†“
Graphics Layer (Vulkan å°è£…)
```

### ECS å±‚æ¬¡
```
World (ECS å®¹å™¨)
  â”œâ”€â”€ Registry (ç»„ä»¶æ³¨å†Œè¡¨)
  â”‚   â””â”€â”€ ComponentStorage (Sparse Set)
  â””â”€â”€ SystemManager (ç³»ç»Ÿç®¡ç†)
      â””â”€â”€ System (ç³»ç»ŸåŸºç±»)
```

### Scene æ ‘æ¶æ„ï¼ˆEnTT æ–¹å¼ï¼‰
- ä½¿ç”¨ `HierarchyComponent` è¡¨ç¤ºçˆ¶å­å…³ç³»
- é€šè¿‡ `TransformSystem` å¤„ç†å±‚çº§å˜æ¢
- ä¸ä½¿ç”¨ä¼ ç»Ÿ OO æ ‘ç»“æ„

### é˜´å½±æ¸²æŸ“æµç¨‹
```
Frame Start
  â†’ Shadow Passï¼ˆä»å…‰æºè§†è§’æ¸²æŸ“ï¼‰
  â†’ Main Passï¼ˆä»ç›¸æœºè§†è§’æ¸²æŸ“ï¼Œé‡‡æ · Shadow Mapï¼‰
Frame End
```

---

## ğŸ”„ å¼€å‘æµç¨‹

### è¿­ä»£ 1: ImGui åŸºç¡€ï¼ˆWeek 1-2ï¼‰
- é›†æˆ ImGui
- åŸºç¡€è°ƒè¯•é¢æ¿
- æ€§èƒ½ç›‘æ§

### è¿­ä»£ 2: ECS æ ¸å¿ƒï¼ˆWeek 3-5ï¼‰
- Entity, Registry, World
- TransformComponent, RenderSystem
- åŸºç¡€æ¸²æŸ“é›†æˆ

### è¿­ä»£ 3: æ¸²æŸ“ä¼˜åŒ–ï¼ˆWeek 6-8ï¼‰
- RenderQueue
- æ‰¹é‡æ¸²æŸ“
- ç›¸æœºç³»ç»Ÿ

### è¿­ä»£ 4: æè´¨å’Œå…‰ç…§ï¼ˆWeek 9-11ï¼‰
- æè´¨ç³»ç»Ÿ
- å…‰ç…§ç³»ç»Ÿ
- å¤š Pipeline

### è¿­ä»£ 5: é˜´å½±ç³»ç»Ÿï¼ˆWeek 12-14ï¼‰
- Shadow Pass
- é˜´å½±é‡‡æ ·
- æ€§èƒ½ä¼˜åŒ–

---

## ğŸ“ ä»£ç ç»„ç»‡åŸåˆ™

### å¼•æ“å±‚ vs åº”ç”¨å±‚

**å¼•æ“å±‚** (`engine/src/`)ï¼š
- æ ¸å¿ƒç³»ç»Ÿï¼ˆECS, Render, Graphicsï¼‰
- é€šç”¨å·¥å…·ï¼ˆLogger, Configï¼‰
- ä¸åŒ…å«åº”ç”¨ç‰¹å®šé€»è¾‘

**åº”ç”¨å±‚** (`app/`)ï¼š
- åº”ç”¨å…¥å£ï¼ˆmain.cppï¼‰
- åº”ç”¨ç‰¹å®šé€»è¾‘
- ä½¿ç”¨å¼•æ“æä¾›çš„æ¥å£

### ç»„ä»¶å’Œç³»ç»Ÿä½ç½®

**å¼•æ“æä¾›çš„** (`engine/src/ecs/components/`, `engine/src/ecs/systems/`)ï¼š
- åŸºç¡€ç»„ä»¶ï¼ˆTransform, Mesh, Cameraï¼‰
- åŸºç¡€ç³»ç»Ÿï¼ˆTransformSystem, RenderSystemï¼‰

**åº”ç”¨æ‰©å±•çš„** (`app/components/`, `app/systems/`)ï¼š
- æ¸¸æˆç‰¹å®šç»„ä»¶
- æ¸¸æˆç‰¹å®šç³»ç»Ÿ

---

## âœ… æ£€æŸ¥æ¸…å•

### Phase 1 å®Œæˆæ ‡å‡†
- [ ] ImGui å¯ä»¥æ­£å¸¸æ˜¾ç¤º
- [ ] æ€§èƒ½ç›‘æ§é¢æ¿å·¥ä½œ
- [ ] å¯ä»¥æŸ¥çœ‹èµ„æºä¿¡æ¯
- [ ] å¯ä»¥ä¿®æ”¹é…ç½®

### Phase 2 å®Œæˆæ ‡å‡†
- [ ] å¯ä»¥åˆ›å»ºå®ä½“å’Œç»„ä»¶
- [ ] ç³»ç»Ÿå¯ä»¥æ­£å¸¸è¿è¡Œ
- [ ] ä½¿ç”¨ ECS æ¸²æŸ“åœºæ™¯
- [ ] å±‚çº§å…³ç³»æ­£å¸¸å·¥ä½œ

### Phase 3 å®Œæˆæ ‡å‡†
- [ ] æ¸²æŸ“é˜Ÿåˆ—æ­£å¸¸å·¥ä½œ
- [ ] æ‰¹é‡æ¸²æŸ“æ€§èƒ½æå‡
- [ ] ç›¸æœºç³»ç»Ÿå®Œæ•´
- [ ] æè´¨ç³»ç»Ÿå¯ç”¨
- [ ] é˜´å½±æ¸²æŸ“æ­£å¸¸
- [ ] å…‰ç…§ç³»ç»Ÿå·¥ä½œ

---

## ğŸ¯ æˆåŠŸæŒ‡æ ‡

### æ€§èƒ½æŒ‡æ ‡
- **Draw Call å‡å°‘** - é€šè¿‡æ‰¹é‡æ¸²æŸ“å‡å°‘ 50%+
- **Frame Time** - 60 FPS ç¨³å®šè¿è¡Œ
- **Shadow Pass** - å æ¸²æŸ“æ—¶é—´ < 30%

### åŠŸèƒ½æŒ‡æ ‡
- **ECS ç³»ç»Ÿ** - æ”¯æŒ 1000+ å®ä½“
- **æ¸²æŸ“ç³»ç»Ÿ** - æ”¯æŒå¤š Passã€é˜´å½±ã€å…‰ç…§
- **å¼€å‘å·¥å…·** - ImGui è°ƒè¯•å·¥å…·å®Œæ•´

---

## ğŸ”„ åç»­è§„åˆ’ï¼ˆPhase 4+ï¼‰

### Phase 4: é«˜çº§ç‰¹æ€§
- åå¤„ç†æ•ˆæœï¼ˆBloom, SSAOï¼‰
- ç²’å­ç³»ç»Ÿ
- åŠ¨ç”»ç³»ç»Ÿ

### Phase 5: å·¥å…·å’Œç¼–è¾‘å™¨
- åœºæ™¯ç¼–è¾‘å™¨
- èµ„æºç¼–è¾‘å™¨
- è„šæœ¬ç³»ç»Ÿ

### Phase 6: å¹³å°æ”¯æŒ
- å¤šå¹³å°æ”¯æŒï¼ˆWindows, Linux, Androidï¼‰
- ç§»åŠ¨ç«¯ä¼˜åŒ–

---

## ğŸ“ æ€»ç»“

**å½“å‰ä¼˜å…ˆçº§**ï¼š
1. âœ… **ImGui åŸºç¡€éƒ¨ç½²** - å¼€å‘å·¥å…·åŸºç¡€
2. âœ… **ECS åŸºæœ¬åŠŸèƒ½** - æ¶æ„åŸºç¡€
3. âœ… **æ¸²æŸ“ç³»ç»Ÿå®Œå–„** - åŠŸèƒ½å®Œå–„

**é¢„è®¡æ—¶é—´**ï¼š8-14 å‘¨

**å…³é”®é‡Œç¨‹ç¢‘**ï¼š
- Week 2: ImGui å¯ç”¨
- Week 5: ECS æ ¸å¿ƒå®Œæˆ
- Week 14: æ¸²æŸ“ç³»ç»Ÿå®Œå–„

